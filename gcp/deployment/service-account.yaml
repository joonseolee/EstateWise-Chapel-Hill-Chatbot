resources:
  - name: estatewise-run-sa
    type: iam.v1.serviceAccount
    properties:
      accountId: estatewise-run
      displayName: 'EstateWise Cloud Run Service Account'

  - name: grant-storage-access
    type: gcp-types/cloudresourcemanager-v1:virtual.projects.iamMemberBinding
    properties:
      resource: projects/$(projectId)
      role: roles/storage.objectAdmin
      member: serviceAccount:$(ref.estatewise-run-sa.email)

  - name: grant-secret-access
    type: gcp-types/cloudresourcemanager-v1:virtual.projects.iamMemberBinding
    properties:
      resource: projects/$(projectId)
      role: roles/secretmanager.secretAccessor
      member: serviceAccount:$(ref.estatewise-run-sa.email)

  - name: grant-logging-access
    type: gcp-types/cloudresourcemanager-v1:virtual.projects.iamMemberBinding
    properties:
      resource: projects/$(projectId)
      role: roles/logging.logWriter
      member: serviceAccount:$(ref.estatewise-run-sa.email)

  - name: grant-monitoring-access
    type: gcp-types/cloudresourcemanager-v1:virtual.projects.iamMemberBinding
    properties:
      resource: projects/$(projectId)
      role: roles/monitoring.metricWriter
      member: serviceAccount:$(ref.estatewise-run-sa.email)
